    <!DOCTYPEhtml>
    <html>
    <head>
    <title>贪吃蛇在线游戏SnakeGameOnline</title>
    </head>
    <body>
    <canvasid="canvas"width="400"height="400"></canvas>
    <scriptsrc="https://code.jquery.com/jquery-2.1.0.js"></script>
    <script>
    //Setupcanvas
    varcanvas=document.getElementById("canvas");
    varctx=canvas.getContext("2d");
    //Getthewidthandheightfromthecanvaselement
    varwidth=canvas.width;
    varheight=canvas.height;
    //Workoutthewidthandheightinblocks
    varblockSize=10;
    varwidthInBlocks=width/blockSize;
    varheightInBlocks=height/blockSize;
    //Setscoreto0
    varscore=0;
    //Drawtheborder
    vardrawBorder=function(){
    ctx.fillStyle="Gray";
    ctx.fillRect(0,0,width,blockSize);
    ctx.fillRect(0,height-blockSize,width,blockSize);
    ctx.fillRect(0,0,blockSize,height);
    ctx.fillRect(width-blockSize,0,blockSize,height);
    };
    //Drawthescoreinthetop-leftcorner
    vardrawScore=function(){
    ctx.font="20pxCourier";
    ctx.fillStyle="Black";
    ctx.textAlign="left";
    ctx.textBaseline="top";
    ctx.fillText("Score:"+score,blockSize,blockSize);
    };
    //CleartheintervalanddisplayGameOvertext
    vargameOver=function(){
    clearInterval(intervalId);
    ctx.font="60pxCourier";
    ctx.fillStyle="Black";
    ctx.textAlign="center";
    ctx.textBaseline="middle";
    ctx.fillText("GameOver",width/2,height/2);
    };
    //Drawacircle(usingthefunctionfromChapter14)
    varcircle=function(x,y,radius,fillCircle){
    ctx.beginPath();
    ctx.arc(x,y,radius,0,Math.PI*2,false);
    if(fillCircle){
    ctx.fill();
    }else{
    ctx.stroke();
    }
    };
    //TheBlockconstructor
    varBlock=function(col,row){
    this.col=col;
    this.row=row;
    };
    //Drawasquareattheblock'slocation
    Block.prototype.drawSquare=function(color){
    varx=this.col*blockSize;
    vary=this.row*blockSize;
    ctx.fillStyle=color;
    ctx.fillRect(x,y,blockSize,blockSize);
    };
    //Drawacircleattheblock'slocation
    Block.prototype.drawCircle=function(color){
    varcenterX=this.col*blockSize+blockSize/2;
    varcenterY=this.row*blockSize+blockSize/2;
    ctx.fillStyle=color;
    circle(centerX,centerY,blockSize/2,true);
    };
    //Checkifthisblockisinthesamelocationasanotherblock
    Block.prototype.equal=function(otherBlock){
    returnthis.col===otherBlock.col&&this.row===otherBlock.row;
    };
    //TheSnakeconstructor
    varSnake=function(){
    this.segments=[
    newBlock(7,5),
    newBlock(6,5),
    newBlock(5,5)
    ];
    this.direction="right";
    this.nextDirection="right";
    };
    //Drawasquareforeachsegmentofthesnake'sbody
    Snake.prototype.draw=function(){
    for(vari=0;i<this.segments.length;i++){
    this.segments[i].drawSquare("Blue");
    }
    };
    //Createanewheadandaddittothebeginningof
    //thesnaketomovethesnakeinitscurrentdirection
    Snake.prototype.move=function(){
    varhead=this.segments[0];
    varnewHead;
    this.direction=this.nextDirection;
    if(this.direction==="right"){
    newHead=newBlock(head.col+1,head.row);
    }elseif(this.direction==="down"){
    newHead=newBlock(head.col,head.row+1);
    }elseif(this.direction==="left"){
    newHead=newBlock(head.col-1,head.row);
    }elseif(this.direction==="up"){
    newHead=newBlock(head.col,head.row-1);
    }
    if(this.checkCollision(newHead)){
    gameOver();
    return;
    }
    this.segments.unshift(newHead);
    if(newHead.equal(apple.position)){
    score++;
    apple.move();
    }else{
    this.segments.pop();
    }
    };
    //Checkifthesnake'snewheadhascollidedwiththewalloritself
    Snake.prototype.checkCollision=function(head){
    varleftCollision=(head.col===0);
    vartopCollision=(head.row===0);
    varrightCollision=(head.col===widthInBlocks-1);
    varbottomCollision=(head.row===heightInBlocks-1);
    varwallCollision=leftCollision||topCollision||rightCollision||bottomCollision;
    varselfCollision=false;
    for(vari=0;i<this.segments.length;i++){
    if(head.equal(this.segments[i])){
    selfCollision=true;
    }
    }
    returnwallCollision||selfCollision;
    };
    //Setthesnake'snextdirectionbasedonthekeyboard
    Snake.prototype.setDirection=function(newDirection){
    if(this.direction==="up"&&newDirection==="down"){
    return;
    }elseif(this.direction==="right"&&newDirection==="left"){
    return;
    }elseif(this.direction==="down"&&newDirection==="up"){
    return;
    }elseif(this.direction==="left"&&newDirection==="right"){
    return;
    }
    this.nextDirection=newDirection;
    };
    //TheAppleconstructor
    varApple=function(){
    this.position=newBlock(10,10);
    };
    //Drawacircleattheapple'slocation
    Apple.prototype.draw=function(){
    this.position.drawCircle("LimeGreen");
    };
    //Movetheappletoanewrandomlocation
    Apple.prototype.move=function(){
    varrandomCol=Math.floor(Math.random()*(widthInBlocks-2))+1;
    varrandomRow=Math.floor(Math.random()*(heightInBlocks-2))+1;
    this.position=newBlock(randomCol,randomRow);
    };
    //Createthesnakeandappleobjects
    varsnake=newSnake();
    varapple=newApple();
    //PassananimationfunctiontosetInterval
    varintervalId=setInterval(function(){
    ctx.clearRect(0,0,width,height);
    drawScore();
    snake.move();
    snake.draw();
    apple.draw();
    drawBorder();
    },100);
    //Convertkeycodestodirections
    vardirections={
    37:"left",
    38:"up",
    39:"right",
    40:"down"
    };
    //Thekeydownhandlerforhandlingdirectionkeypresses
    $("body").keydown(function(event){
    varnewDirection=directions[event.keyCode];
    if(newDirection!==undefined){
    snake.setDirection(newDirection);
    }
    });
    </script>
    </body>
    </html>
